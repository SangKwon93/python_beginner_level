# Hadoop 

## 역할

- 대용량 데이터를 다루기 위해 필요

- 대용량 파일은 센서나 웹 서버 등으로부터 받아오는 정보(ex 로그) 등등

  ​

## 장점

- 하드 드라이브의 용량보다 훨씬 큰 파일 저장 가능

- 단일 컴퓨터가 다운되더라도 문제되지 않음

  (소실된 블록의 복사본을 가진 다른 노드로 대체 작동)

  ​

## 특징

1. 파일을 먼저 데이터 블록으로 분리 (블록 기본값 128mb)

2. HDFS는 이 대용량 파일을 분산해서 처리

   - 분산하여 여러 컴퓨터에 저장했다면 각 컴퓨터는 저장된 데이터 블록을 동시에 처리 할 수 있어

   - 데이터 블록을 처리하는 컴퓨터가 해당 블록이 저장된 곳이랑 물리적으로 가까운 거리에 있도록 조정

     => 데이터를 더 효율적으로 엑세스 할 수 있게

3.  실패를 관리하기 위해  두개 이상의 복사본을 저장

   - HDFS가 데이터 블록의 백업 복사본을 갖고 있는 다른 컴퓨터에서 정보를 불러옴

     (단일노드가 다운되더라도 그 어떤 블록도 잃어버리지 않음)

## 작동 원리

1. 노드 

   - 어느 블록이 어디에 있는지 추적
   - 주어진 파일의 이름과 HDFS 내의 가상 디렉터리 구조 등 정보를 가지고 있어
   - 정보 관련 모든 불록과 해당 복사본들이 어떤 노드에 저장되어 있는지 기록

   ​

2.  편집 로그

   - 무엇이 생성되고 어떤게 수정되고 저장되는지 등의 정보가 기록
   - 변경사항도 기록
   - ​

   => 데이터 노드에 무엇이 있는지는 이름 노드에 기록

   => 클라이언트 애플리케이션은 이름 노드에 쿼리해 어디로 가야할 지 알아낸 다음 그 데이터 노드와 애기해 

   => 데이터 노드가 실제 파일의 블록을 저장하는 곳이며 두 노드는 블록의 복사본을 잘 유지하기 위해 서로 소통



## HDFS에서 파일을 읽는 예

- 클라이언트 노드에서 작동 중인 어떤 애플리케이션이 HDFS 저장 되어있는 데이터를 엑세스하려한다.

- 애플리케이션은 먼저 이름 노드에게 파일a가 필요하다고 말한다.

- 이름노드는 파일a는 이러이러한 데이터 노드의 요러한 블록에 저장되어 있다고 알려줌

- 클라이언트 애플리케이션은 해당 데이터 노드에 방문해 그 블록들을 가져와 파일 a를 구성

- 클라이언트 라이브러리가 사용된다.

  ​

  => 클라이언트가 먼저 이름 노드에게 그 파일이 어떤 데이터 노드의 어느 블록에 있는지,

  어떤 데이터 노드에게 가는게 가장 효율적인지 등을 물어보면 이름노드가 어디로 가야한다고 알려주는 개념



## HDFS에 파일을 쓰려면 어떻게 해야할까?

- 이름노드에게 이야기하면 이러한 데이터 노드에 저장하라고 정해준다.

- 클라이언트는 그 중 첫번째 데이터 노드에게 데이터를 전달한다.

- 그 데이터 노드는 블록을 저장하고 데이터 노드에 복사본을 전달하고 그 다음 노드에 다시 전달

- 최종적으로 모든 데이터 노드에 파일이 성공적으로 복사되면 잘 받았다는 수신 신호가 전달되어 클라이언트를 통해 이름노드로 전달

  => 그럼 파일이 잘 저장되었다고 기록하며 파일을 읽을 수 있다.



#### 의문점 : 이름노드가 왜 하나밖에 없지?

- 블록의 위치에 관해 클라이언트 간에 혼선을 줄 수 있어 한번에 하나의 이름 노드만 사용



## 어떻게 사용하나?

유저 인터페이스를 사용하는 방법

- 단순히 파일을 복사하고 HDFS의 디렉토리 구조를 시각화하고 싶을 때 
- HDFS는 클러스터의 수많은 컴퓨터에 걸쳐 분산되어 있고 실패 회복력과 큰 가능성이 있지만 결국 파일 시스템을 갖춘 거대한 하드 드라이브